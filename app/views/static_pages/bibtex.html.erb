<% cp = CiteProc::Processor.new style: 'apa', format: 'html' %>
<% cp.import BibTeX.open('./public/bibtex/dialectica-sandro.bib').to_citeproc %>
<% array_of_ids = [] %>
<% @b['@article'].each do |article| %>
  <% array_of_ids.push(article.id) %>
<% end %>


<div class="container">



  <h3>Searching DOI with CrossRef-API (5 random examples from bib-file):</h3>
  <% array_of_ids.sample(5).each do |id| %>
  <% citation = raw (cp.render :bibliography, id: id).first %>
  <li>
    <%= citation %>
    <br />
    <strong>Found DOI-Links</strong><br />
    <% Serrano.works(query: citation)["message"]["items"].each do |item|%>
      <%=  link_to item["URL"], item["URL"]  %><br />
    <% end %>

    <br />
    <br />
  </li>

  <% end %>

  <hr />
  <h1>Bibtex</h1>
  <% array_of_ids.each do |id| %>
  <% citation = raw (cp.render :bibliography, id: id).first %>
  <p>
    <%= citation %>
    <%#= CiteProc.process @b[id].to_citeproc, :style => :apa %>
  </p>

  <% end %>
</div>
